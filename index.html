<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSR Gacha Simulator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .stats-card { border-left: 5px solid #0d6efd; }
        .history-box { max-height: 150px; overflow-y: auto; background: #eee; padding: 10px; border-radius: 5px; font-family: monospace; }
    </style>
</head>
<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white text-center">
                    <h3> Gacha Simulator </h3>
                </div>
                <div class="card-body">
                   

                    <div class="row g-3 text-center mb-4">
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>B5 Limited</h6>
                                <h4 id="countL" class="text-primary">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>B5 Standard</h6>
                                <h4 id="countS" class="text-secondary">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Current Pity</h6>
                                <h4 id="currPity">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Total Pulls</h6>
                                <h4 id="totalPulls">0</h4>
                            </div>
                        </div>
                    </div>

                    <div id="statusBanner" class="alert alert-warning text-center fw-bold">
                        STATUS: 50/50 RATE-OFF
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Limited (Avg: <span id="avgL">0</span>)</label>
                            <div id="histL" class="history-box"></div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Standard</label>
                            <div id="histS" class="history-box text-muted"></div>
                        </div>
                    </div>
<div class="row mt-4">
    <div class="col-12">
        <label class="fw-bold">Global Timeline (B5 Appearances):</label>
        <div id="timelineBox" class="history-box" style="min-height: 100px; display: flex; flex-wrap: wrap; align-content: flex-start;">
            </div>
    </div>
</div>

<div class="input-group mt-4">
                        <span class="input-group-text">Pulls</span>
                        <input type="number" id="pullsInput" class="form-control" placeholder="Enter number of pulls (e.g. 100)" min="1">
                        <button class="btn btn-primary" onclick="runGacha()">Gacha!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Global Variables (State)
    let currentPity = 0;
    let isGuaranteed = false;
    let totalLimitedB5 = 0;
    let totalStandB5 = 0;
    let totalPullsCount = 0;
let timelinePity = [];
    let historyPityL = [];
    let historyPityS = []; // New Feature: Standard History

    function runGacha() {
        const input = document.getElementById('pullsInput');
        const pulls = parseInt(input.value);

        if (isNaN(pulls) || pulls <= 0) return alert("Please enter a valid number!");

        for (let i = 0; i < pulls; i++) {
            currentPity++;
            totalPullsCount++;

            let pullRate = 0.006; // Default
           // if (currentPity >= 81 && currentPity < 90) pullRate = 0.50;
          //  else if (currentPity >= 60) pullRate = 0.05;
           // else if (currentPity <= 20) pullRate = 0.012;

            if (currentPity === 90 || Math.random() < pullRate) {
                // Winning 5-Star
                if (isGuaranteed || Math.random() < 0.5) {
                    totalLimitedB5++;
                    historyPityL.push(currentPity);
timelinePity.push({ globalPull: totalPullsCount, type: 'L', pity: currentPity });
                    isGuaranteed = false;
                } else {
                    totalStandB5++;
                    historyPityS.push(currentPity); // Capture Standard Pity
timelinePity.push({ globalPull: totalPullsCount, type: 'S', pity: currentPity });
                    isGuaranteed = true;
                }
                currentPity = 0; // Reset Pity
            }
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('countL').innerText = totalLimitedB5;
        document.getElementById('countS').innerText = totalStandB5;
        document.getElementById('currPity').innerText = currentPity;
        document.getElementById('totalPulls').innerText = totalPullsCount;
        
        // Update History Displays
        document.getElementById('histL').innerText = JSON.stringify(historyPityL);
        document.getElementById('histS').innerText = JSON.stringify(historyPityS);

        // Calculate Average for Limited
        if (historyPityL.length > 0) {
            let avg = historyPityL.reduce((a, b) => a + b, 0) / historyPityL.length;
            document.getElementById('avgL').innerText = avg.toFixed(1);
        }

        // Update Status Banner
        const banner = document.getElementById('statusBanner');
        if (isGuaranteed) {
            banner.innerText = "STATUS: GUARANTEED NEXT B5";
            banner.className = "alert alert-success text-center fw-bold";
        } else {
            banner.innerText = "STATUS: 50/50 RATE-OFF";
            banner.className = "alert alert-warning text-center fw-bold";
        }
// 3. Menampilkan Timeline dengan warna berbeda
        const timelineBox = document.getElementById('timelineBox');
        timelineBox.innerHTML = ''; // Clear dulu biar ga double

        timelinePity.forEach(item => {
            const span = document.createElement('span');
            // Jika L warna Biru (Limited), Jika S warna Abu-abu (Standard)
            const badgeClass = item.type === 'L' ? 'bg-warning' : 'bg-primary';
            
            span.className = `badge ${badgeClass} me-2 mb-2 p-2`;
            span.innerHTML = `Pull #${item.globalPull} (Pity ${item.pity})`;
            timelineBox.appendChild(span);
        });
    }
</script>

</body>
</html>                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Current Pity</h6>
                                <h4 id="currPity">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Total Pulls</h6>
                                <h4 id="totalPulls">0</h4>
                            </div>
                        </div>
                    </div>

                    <div id="statusBanner" class="alert alert-warning text-center fw-bold">
                        STATUS: 50/50 RATE-OFF
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Limited (Avg: <span id="avgL">0</span>)</label>
                            <div id="histL" class="history-box"></div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Standard</label>
                            <div id="histS" class="history-box text-muted"></div>
                        </div>
                    </div>
<div class="row mt-4">
    <div class="col-12">
        <label class="fw-bold">Global Timeline (B5 Appearances):</label>
        <div id="timelineBox" class="history-box" style="min-height: 100px; display: flex; flex-wrap: wrap; align-content: flex-start;">
            </div>
    </div>
</div>

<div class="input-group mt-4">
                        <span class="input-group-text">Pulls</span>
                        <input type="number" id="pullsInput" class="form-control" placeholder="Enter number of pulls (e.g. 100)" min="1">
                        <button class="btn btn-primary" onclick="runGacha()">Gacha!</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Global Variables (State)
    let currentPity = 0;
    let isGuaranteed = false;
    let totalLimitedB5 = 0;
    let totalStandB5 = 0;
    let totalPullsCount = 0;
let timelinePity = [];
    let historyPityL = [];
    let historyPityS = []; // New Feature: Standard History

    function runGacha() {
        const input = document.getElementById('pullsInput');
        const pulls = parseInt(input.value);

        if (isNaN(pulls) || pulls <= 0) return alert("Please enter a valid number!");

        for (let i = 0; i < pulls; i++) {
            currentPity++;
            totalPullsCount++;

            let pullRate = 0.006; // Default
           // if (currentPity >= 81 && currentPity < 90) pullRate = 0.50;
          //  else if (currentPity >= 60) pullRate = 0.05;
           // else if (currentPity <= 20) pullRate = 0.012;

            if (currentPity === 90 || Math.random() < pullRate) {
                // Winning 5-Star
                if (isGuaranteed || Math.random() < 0.5) {
                    totalLimitedB5++;
                    historyPityL.push(currentPity);
timelinePity.push({ globalPull: totalPullsCount, type: 'L', pity: currentPity });
                    isGuaranteed = false;
                } else {
                    totalStandB5++;
                    historyPityS.push(currentPity); // Capture Standard Pity
timelinePity.push({ globalPull: totalPullsCount, type: 'S', pity: currentPity });
                    isGuaranteed = true;
                }
                currentPity = 0; // Reset Pity
            }
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('countL').innerText = totalLimitedB5;
        document.getElementById('countS').innerText = totalStandB5;
        document.getElementById('currPity').innerText = currentPity;
        document.getElementById('totalPulls').innerText = totalPullsCount;
        
        // Update History Displays
        document.getElementById('histL').innerText = JSON.stringify(historyPityL);
        document.getElementById('histS').innerText = JSON.stringify(historyPityS);

        // Calculate Average for Limited
        if (historyPityL.length > 0) {
            let avg = historyPityL.reduce((a, b) => a + b, 0) / historyPityL.length;
            document.getElementById('avgL').innerText = avg.toFixed(1);
        }

        // Update Status Banner
        const banner = document.getElementById('statusBanner');
        if (isGuaranteed) {
            banner.innerText = "STATUS: GUARANTEED NEXT B5";
            banner.className = "alert alert-success text-center fw-bold";
        } else {
            banner.innerText = "STATUS: 50/50 RATE-OFF";
            banner.className = "alert alert-warning text-center fw-bold";
        }
// 3. Menampilkan Timeline dengan warna berbeda
        const timelineBox = document.getElementById('timelineBox');
        timelineBox.innerHTML = ''; // Clear dulu biar ga double

        timelinePity.forEach(item => {
            const span = document.createElement('span');
            // Jika L warna Biru (Limited), Jika S warna Abu-abu (Standard)
            const badgeClass = item.type === 'L' ? 'bg-warning' : 'bg-primary';
            
            span.className = `badge ${badgeClass} me-2 mb-2 p-2`;
            span.innerHTML = `Pull #${item.globalPull} (Pity ${item.pity})`;
            timelineBox.appendChild(span);
        });
    }
</script>

</body>
</html>                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>B5 Standard</h6>
                                <h4 id="countS" class="text-secondary">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Current Pity</h6>
                                <h4 id="currPity">0</h4>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="p-3 border bg-light rounded shadow-sm">
                                <h6>Total Pulls</h6>
                                <h4 id="totalPulls">0</h4>
                            </div>
                        </div>
                    </div>

                    <div id="statusBanner" class="alert alert-warning text-center fw-bold">
                        STATUS: 50/50 RATE-OFF
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Limited (Avg: <span id="avgL">0</span>)</label>
                            <div id="histL" class="history-box"></div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="fw-bold">History Pity Standard</label>
                            <div id="histS" class="history-box text-muted"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Global Variables (State)
    let currentPity = 0;
    let isGuaranteed = false;
    let totalLimitedB5 = 0;
    let totalStandB5 = 0;
    let totalPullsCount = 0;
    let historyPityL = [];
    let historyPityS = []; // New Feature: Standard History

    function runGacha() {
        const input = document.getElementById('pullsInput');
        const pulls = parseInt(input.value);

        if (isNaN(pulls) || pulls <= 0) return alert("Please enter a valid number!");

        for (let i = 0; i < pulls; i++) {
            currentPity++;
            totalPullsCount++;

            let pullRate = 0.006; // Default
            if (currentPity >= 81 && currentPity < 90) pullRate = 0.50;
            else if (currentPity >= 60) pullRate = 0.05;
            else if (currentPity <= 20) pullRate = 0.012;

            if (currentPity === 90 || Math.random() < pullRate) {
                // Winning 5-Star
                if (isGuaranteed || Math.random() < 0.5) {
                    totalLimitedB5++;
                    historyPityL.push(currentPity);
                    isGuaranteed = false;
                } else {
                    totalStandB5++;
                    historyPityS.push(currentPity); // Capture Standard Pity
                    isGuaranteed = true;
                }
                currentPity = 0; // Reset Pity
            }
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('countL').innerText = totalLimitedB5;
        document.getElementById('countS').innerText = totalStandB5;
        document.getElementById('currPity').innerText = currentPity;
        document.getElementById('totalPulls').innerText = totalPullsCount;
        
        // Update History Displays
        document.getElementById('histL').innerText = JSON.stringify(historyPityL);
        document.getElementById('histS').innerText = JSON.stringify(historyPityS);

        // Calculate Average for Limited
        if (historyPityL.length > 0) {
            let avg = historyPityL.reduce((a, b) => a + b, 0) / historyPityL.length;
            document.getElementById('avgL').innerText = avg.toFixed(1);
        }

        // Update Status Banner
        const banner = document.getElementById('statusBanner');
        if (isGuaranteed) {
            banner.innerText = "STATUS: GUARANTEED NEXT B5";
            banner.className = "alert alert-success text-center fw-bold";
        } else {
            banner.innerText = "STATUS: 50/50 RATE-OFF";
            banner.className = "alert alert-warning text-center fw-bold";
        }
    }
</script>

</body>
</html>
